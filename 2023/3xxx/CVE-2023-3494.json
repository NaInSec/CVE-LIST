{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-3494",
        "assignerOrgId": "63664ac6-956c-4cba-a5d0-f46076e16109",
        "state": "PUBLISHED",
        "assignerShortName": "freebsd",
        "dateReserved": "2023-06-30T22:57:48.603Z",
        "datePublished": "2023-08-01T22:13:21.634Z",
        "dateUpdated": "2023-08-01T22:34:32.578Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "modules": [
                        "bhyve"
                    ],
                    "product": "FreeBSD",
                    "vendor": "FreeBSD",
                    "versions": [
                        {
                            "lessThan": "13.2-RELEASE-p2",
                            "status": "affected",
                            "version": "13.2-RELEASE",
                            "versionType": "release"
                        },
                        {
                            "lessThan": "13.1-RELEASE-p9",
                            "status": "affected",
                            "version": "13.1-RELEASE",
                            "versionType": "release"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Only bhyve guests that are executed with the \"-l bootrom\" option are affected.<br>"
                        }
                    ],
                    "value": "Only bhyve guests that are executed with the \"-l bootrom\" option are affected.\n"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "user": "00000000-0000-4000-9000-000000000000",
                    "value": "Omri Ben Bassat and Vladimir Eli Tokarev from Microsoft"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<div>The fwctl driver implements a state machine which is executed when a bhyve guest accesses certain x86 I/O ports.  The interface lets the guest copy a string into a buffer resident in the bhyve process' memory.  A bug in the state machine implementation can result in a buffer overflowing when copying this string. Malicious, privileged software running in a guest VM can exploit the buffer overflow to achieve code execution on the host in the bhyve userspace process, which typically runs as root, mitigated by the capabilities assigned through the Capsicum sandbox available to the bhyve process.<br></div>"
                        }
                    ],
                    "value": "The fwctl driver implements a state machine which is executed when a bhyve guest accesses certain x86 I/O ports.  The interface lets the guest copy a string into a buffer resident in the bhyve process' memory.  A bug in the state machine implementation can result in a buffer overflowing when copying this string. Malicious, privileged software running in a guest VM can exploit the buffer overflow to achieve code execution on the host in the bhyve userspace process, which typically runs as root, mitigated by the capabilities assigned through the Capsicum sandbox available to the bhyve process.\n\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-100",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-100 Overflow Buffers"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-120",
                            "description": "CWE-120 Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "63664ac6-956c-4cba-a5d0-f46076e16109",
                "shortName": "freebsd",
                "dateUpdated": "2023-08-01T22:34:32.578Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://security.FreeBSD.org/advisories/FreeBSD-SA-23:07.bhyve.asc"
                },
                {
                    "url": "https://security.netapp.com/advisory/ntap-20230831-0006/"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "bhyve privileged guest escape via fwctl",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}