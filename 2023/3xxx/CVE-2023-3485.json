{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-3485",
        "assignerOrgId": "61241ed8-fa44-4f23-92db-b8c443751968",
        "state": "PUBLISHED",
        "assignerShortName": "Temporal",
        "dateReserved": "2023-06-30T17:29:17.808Z",
        "datePublished": "2023-06-30T17:37:57.772Z",
        "dateUpdated": "2023-06-30T17:38:22.233Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://github.com/temporalio",
                    "defaultStatus": "unaffected",
                    "packageName": "temporal",
                    "product": "Temporal Server",
                    "programFiles": [
                        "https://github.com/temporalio/temporal/blob/master/service/frontend/service.go"
                    ],
                    "repo": "https://github.com/temporalio/temporal",
                    "vendor": "Temporal Technologies Inc.",
                    "versions": [
                        {
                            "lessThan": "1.20",
                            "status": "affected",
                            "version": "1.9.1",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "user": "00000000-0000-4000-9000-000000000000",
                    "value": "Jacob LeGrone"
                }
            ],
            "datePublic": "2023-07-03T15:30:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Insecure defaults in open-source Temporal Server before version 1.20 on all platforms allows an attacker to craft a task token with access to a namespace other than the one specified in the request. Creation of this task token must be done outside of the normal Temporal server flow. It requires the namespace UUID and information from the workflow history for the target namespace. Under these conditions, it is possible to interfere with pending tasks in other namespaces, such as marking a task failed or completed.<br>If a task is targeted for completion by the attacker, the targeted namespace must also be using the same data converter configuration as the initial, valid, namespace for the task completion payload to be decoded by workers in the target namespace.<br><br><br><br>"
                        }
                    ],
                    "value": "Insecure defaults in open-source Temporal Server before version 1.20 on all platforms allows an attacker to craft a task token with access to a namespace other than the one specified in the request. Creation of this task token must be done outside of the normal Temporal server flow. It requires the namespace UUID and information from the workflow history for the target namespace. Under these conditions, it is possible to interfere with pending tasks in other namespaces, such as marking a task failed or completed.\nIf a task is targeted for completion by the attacker, the targeted namespace must also be using the same data converter configuration as the initial, valid, namespace for the task completion payload to be decoded by workers in the target namespace.\n\n\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-114",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-114 Authentication Abuse Authentication Abuse"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "LOW",
                        "baseScore": 3,
                        "baseSeverity": "LOW",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "HIGH",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:L/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-863",
                            "description": "CWE-863 Incorrect Authorization3 Incorrect Authorization",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-1188",
                            "description": "CWE-1188 Insecure Default Initialization of Resource Insecure Default Initialization of Resource",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "61241ed8-fa44-4f23-92db-b8c443751968",
                "shortName": "Temporal",
                "dateUpdated": "2023-06-30T17:38:22.233Z"
            },
            "references": [
                {
                    "url": "https://github.com/temporalio/temporal/releases/tag/v1.20.0"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<ul><li><span style=\"background-color: var(--wht);\">Set &nbsp;</span><code><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/temporalio/temporal/pull/3798\">frontend.enableTokenNamespaceEnforcement</a>&nbsp;</code><span style=\"background-color: var(--wht);\">to </span><tt>true</tt><span style=\"background-color: var(--wht);\">&nbsp; </span></li><li><span style=\"background-color: var(--wht);\">Upgrade to version 1.20 or above, where this is the default</span></li></ul>"
                        }
                    ],
                    "value": "  *  Set   frontend.enableTokenNamespaceEnforcement https://github.com/temporalio/temporal/pull/3798  to true  \n  *  Upgrade to version 1.20 or above, where this is the default\n\n\n"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Insecure Default Authorization in Temporal Server",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}