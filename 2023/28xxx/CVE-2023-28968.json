{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "state": "PUBLISHED",
        "cveId": "CVE-2023-28968",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "dateUpdated": "2023-04-17T00:00:00",
        "dateReserved": "2023-03-29T00:00:00",
        "datePublished": "2023-04-17T00:00:00"
    },
    "containers": {
        "cna": {
            "title": "Junos OS: SRX Series: Policies that rely on JDPI-Decoder actions may fail open",
            "datePublic": "2023-04-12T00:00:00",
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2023-04-17T00:00:00"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "An Improperly Controlled Sequential Memory Allocation vulnerability in the Juniper Networks Deep Packet Inspection-Decoder (JDPI-Decoder) Application Signature component of Junos OS's AppID service on SRX Series devices will stop the JDPI-Decoder from identifying dynamic application traffic, allowing an unauthenticated network-based attacker to send traffic to the target device using the JDPI-Decoder, designed to inspect dynamic application traffic and take action upon this traffic, to instead begin to not take action and to pass the traffic through. An example session can be seen by running the following command and evaluating the output. user@device# run show security flow session source-prefix <address/mask> extensive Session ID: <session ID>, Status: Normal, State: Active Policy name: <name of policy> Dynamic application: junos:UNKNOWN, <<<<< LOOK HERE Please note, the JDPI-Decoder and the AppID SigPack are both affected and both must be upgraded along with the operating system to address the matter. By default, none of this is auto-enabled for automatic updates. This issue affects: Juniper Networks any version of the JDPI-Decoder Engine prior to version 5.7.0-47 with the JDPI-Decoder enabled using any version of the AppID SigPack prior to version 1.550.2-31 (SigPack 3533) on Junos OS on SRX Series: All versions prior to 19.1R3-S10; 19.2 versions prior to 19.2R3-S7; 19.3 versions prior to 19.3R3-S8; 19.4 versions prior to 19.4R3-S11; 20.1 version 20.1R1 and later versions prior to 20.2R3-S7; 20.3 version 20.3R1 and later versions prior to 20.4R3-S6; 21.1 versions prior to 21.1R3-S5; 21.2 versions prior to 21.2R3-S4; 21.3 versions prior to 21.3R3-S3; 21.4 versions prior to 21.4R3-S3; 22.1 versions prior to 22.1R3-S1; 22.2 versions prior to 22.2R2-S1, 22.2R3; 22.3 versions prior to 22.3R1-S2, 22.3R2;"
                }
            ],
            "affected": [
                {
                    "vendor": "Juniper Networks",
                    "product": " Junos OS",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "19.1R3-S10",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "19.2",
                            "status": "affected",
                            "lessThan": "19.2R3-S7",
                            "versionType": "custom"
                        },
                        {
                            "version": "19.3",
                            "status": "affected",
                            "lessThan": "19.3R3-S8",
                            "versionType": "custom"
                        },
                        {
                            "version": "19.4",
                            "status": "affected",
                            "lessThan": "19.4R3-S11",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.1R1",
                            "status": "affected",
                            "lessThan": "20.1*",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.2",
                            "status": "affected",
                            "lessThan": "20.2R3-S7",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.3R1",
                            "status": "affected",
                            "lessThan": "20.3*",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.4",
                            "status": "affected",
                            "lessThan": "20.4R3-S6",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.1",
                            "status": "affected",
                            "lessThan": "21.1R3-S5",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.2",
                            "status": "affected",
                            "lessThan": "21.2R3-S4",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3",
                            "status": "affected",
                            "lessThan": "21.3R3-S3",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.4",
                            "status": "affected",
                            "lessThan": "21.4R3-S3",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.1",
                            "status": "affected",
                            "lessThan": "22.1R3-S1",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.2",
                            "status": "affected",
                            "lessThan": "22.2R2-S1, 22.2R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.3",
                            "status": "affected",
                            "lessThan": "22.3R2",
                            "versionType": "custom"
                        }
                    ],
                    "platforms": [
                        "SRX Series"
                    ]
                },
                {
                    "vendor": "Juniper Networks",
                    "product": "AppID Service Sigpack",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "1.550.2-31",
                            "status": "affected",
                            "versionType": "custom"
                        }
                    ],
                    "platforms": [
                        "SRX Series"
                    ]
                },
                {
                    "vendor": "Juniper Networks",
                    "product": "JDPI-Decoder Engine",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "5.7.0-47",
                            "status": "affected",
                            "versionType": "custom"
                        }
                    ],
                    "platforms": [
                        "SRX Series"
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://supportportal.juniper.net/JSA70592"
                },
                {
                    "url": "https://www.juniper.net/documentation/us/en/software/jdpi/release-notes/jdpi-decoder-release-notes-october-2022/jdpi-decoder-release-notes-october-2022.pdf"
                },
                {
                    "url": "https://supportportal.juniper.net/s/article/SRX-How-to-update-IDP-signature-database-automatically-on-a-SRX"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "LOW",
                        "availabilityImpact": "NONE",
                        "baseScore": 5.3,
                        "baseSeverity": "MEDIUM"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-1325: Improperly Controlled Sequential Memory Allocation",
                            "cweId": "CWE-1325"
                        }
                    ]
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "source": {
                "advisory": "JSA70592",
                "defect": [
                    "1694222"
                ],
                "discovery": "USER"
            },
            "configurations": [
                {
                    "lang": "en",
                    "value": "\nFor this issue, Security Policy with dynamic application must be configured:\n \n  [security zones security-zone trust]\n  [security zones security-zone untrust]\n  [security policies from-zone “zone” to-zone “zone” policy “policy” match source-address “address”]\n  [security policies from-zone “zone” to-zone “zone” policy “policy” match destination-address “address”]\n  [security policies from-zone “zone” to-zone “zone” policy “policy” match dynamic-application “application”]\n  [security policies from-zone “zone” to-zone “zone” policy “policy” then “action”]"
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "There are no known workarounds for this issue other than disabling the AppID service.\n\nAdditionally, a reboot will temporarily clear the problem until such time that updates can be taken. How long this lasts depends on the customer's network environment and the device being affected.\n\n\n"
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "The following software releases have been updated to resolve this specific issue: 19.4R3-S11, 20.2R3-S7, 20.4R3-S6, 21.1R3-S5, 21.2R3-S4, 21.3R3-S3, 21.4R3-S3, 22.1R3-S1, 22.2R2-S1, 22.2R3, 22.3R1-S2, 22.3R2, 22.4R1, and all subsequent releases.\nPlease note: Prior to Junos OS: 21.2R3-S4, 21.3R3-S3, 21.3R3-S3, 21.4R3-S3, 22.1R3-S1, 22.2R2-S1, 22.2R3, 22.3R2, 22.4R1, and all subsequent releases SOF is incorrectly offloading short-lived flows leading to early exhaustion of NP memory, reducing overall device performance.  Customers should review PRSearch PR1692100 for such details in conjunction with this advisory.\n\n\nCustomers may choose to enable automatic updates for IDP or manually update the IDP security package to receive the fixes. \n\nTo manually download the IDP signatures: \na. Download the IDP security-package on the device:\n  request security idp security-package download\nb. Check the status of the download:\n  request security idp security-package download status\nc. Install the IDP security-package on the device:\n  request security idp security-package install\nd. Check the status of the installation:\n  request security idp security-package install status\n\nTo enabled automatic update review the instuctions located at: https://supportportal.juniper.net/s/article/SRX-How-to-update-IDP-signature-database-automatically-on-a-SRX\n\n== When using AppID only:\n \n  request services application-identification download\n  request services application-identification download status\n  request services application-identification install\n  request services application-identification install status\n \nOr enable auto-update for AppID:\n \n  [edit]\n  user# set services application-identification download automatic ?\n  Possible completions:\n    interval             Attempt to download new application package (hours)\n    start-time           Start time(MM-DD.hh:mm / YYYY-MM-DD.hh:mm:ss)\n \nNote: This updated signature package is not compatible with v4 engines.\n\n\n"
                }
            ]
        }
    }
}