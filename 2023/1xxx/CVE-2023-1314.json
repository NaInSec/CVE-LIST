{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-1314",
        "assignerOrgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
        "state": "PUBLISHED",
        "assignerShortName": "cloudflare",
        "dateReserved": "2023-03-10T11:10:40.020Z",
        "datePublished": "2023-03-21T11:01:14.062Z",
        "dateUpdated": "2023-03-21T11:01:14.062Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "affected",
                    "modules": [
                        "MSI Installer"
                    ],
                    "packageName": "cloudflared",
                    "platforms": [
                        "Windows",
                        "32 bit"
                    ],
                    "product": "cloudflared",
                    "repo": "https://github.com/cloudflare/cloudflared",
                    "vendor": "Cloudflare",
                    "versions": [
                        {
                            "changes": [
                                {
                                    "at": "2023.3.1",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThanOrEqual": "<=2023.3.0",
                            "status": "affected",
                            "version": "0",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "user": "00000000-0000-4000-9000-000000000000",
                    "value": "sim0nsecurity"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>A vulnerability has been discovered in cloudflared's installer (&lt;= 2023.3.0) for Windows 32-bits devices that allows a local attacker with no administrative permissions to escalate their privileges on the affected device. This vulnerability exists because the MSI installer used by cloudflared relied on a world-writable directory.</p><p>An attacker with local access to the device (without Administrator rights) can use symbolic links to trick the MSI installer into deleting files in locations that the attacker would otherwise have no access to. By creating a symlink from the world-writable directory to the target file, the attacker can manipulate the MSI installer's repair functionality to delete the target file during the repair process.</p><p>Exploitation of this vulnerability could allow an attacker to delete important system files or replace them with malicious files, potentially leading to the affected device being compromised.</p><p><strong>The cloudflared client itself is not affected by this vulnerability, only the installer for 32-bit Windows devices.</strong></p>"
                        }
                    ],
                    "value": "A vulnerability has been discovered in cloudflared's installer (<= 2023.3.0) for Windows 32-bits devices that allows a local attacker with no administrative permissions to escalate their privileges on the affected device. This vulnerability exists because the MSI installer used by cloudflared relied on a world-writable directory.\n\nAn attacker with local access to the device (without Administrator rights) can use symbolic links to trick the MSI installer into deleting files in locations that the attacker would otherwise have no access to. By creating a symlink from the world-writable directory to the target file, the attacker can manipulate the MSI installer's repair functionality to delete the target file during the repair process.\n\nExploitation of this vulnerability could allow an attacker to delete important system files or replace them with malicious files, potentially leading to the affected device being compromised.\n\nThe cloudflared client itself is not affected by this vulnerability, only the installer for 32-bit Windows devices.\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-132",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-132 Symlink Attack"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:N/I:H/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-59",
                            "description": "CWE-59 Improper Link Resolution Before File Access ('Link Following')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
                "shortName": "cloudflare",
                "dateUpdated": "2023-03-21T11:01:14.062Z"
            },
            "references": [
                {
                    "url": "https://github.com/cloudflare/cloudflared/security/advisories/GHSA-7mjv-x3jf-545x"
                },
                {
                    "url": "https://github.com/cloudflare/cloudflared/releases"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>A new installer was released as part of version 2023.3.1. Users are encouraged to remove old installers from their systems.</p>"
                        }
                    ],
                    "value": "A new installer was released as part of version 2023.3.1. Users are encouraged to remove old installers from their systems.\n\n"
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "title": "Local Privilege Escalation Vulnerability in cloudflared's Installer",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}