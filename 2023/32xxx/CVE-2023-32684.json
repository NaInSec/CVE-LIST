{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-32684",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2023-05-11T16:33:45.732Z",
        "datePublished": "2023-05-30T17:19:17.148Z",
        "dateUpdated": "2023-05-30T17:19:17.148Z"
    },
    "containers": {
        "cna": {
            "title": "In Lima, a malicious disk image could read a single file on the host filesystem as a qcow2/vmdk backing file",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-552",
                            "lang": "en",
                            "description": "CWE-552: Files or Directories Accessible to External Parties",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "NONE",
                        "baseScore": 2.7,
                        "baseSeverity": "LOW",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "CHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N",
                        "version": "3.1"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/lima-vm/lima/security/advisories/GHSA-f7qw-jj9c-rpq9",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/lima-vm/lima/security/advisories/GHSA-f7qw-jj9c-rpq9"
                },
                {
                    "name": "https://github.com/lima-vm/lima/commit/01dbd4d9cabe692afa4517be3995771f0ebb38a5",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/lima-vm/lima/commit/01dbd4d9cabe692afa4517be3995771f0ebb38a5"
                },
                {
                    "name": "https://github.com/lima-vm/lima/releases/tag/v0.16.0",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/lima-vm/lima/releases/tag/v0.16.0"
                }
            ],
            "affected": [
                {
                    "vendor": "lima-vm",
                    "product": "lima",
                    "versions": [
                        {
                            "version": "< 0.16.0",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2023-05-30T17:19:17.148Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Lima launches Linux virtual machines, typically on macOS, for running containerd. Prior to version 0.16.0, a virtual machine instance with a malicious disk image could read a single file on the host filesystem, even when no filesystem is mounted from the host. The official templates of Lima and the well-known third party products (Colima, Rancher Desktop, and Finch) are unlikely to be affected by this issue. To exploit this issue, the attacker has to embed the target file path (an absolute or a relative path from the instance directory) in a malicious disk image, as the qcow2 (or vmdk) backing file path string. As Lima refuses to run as the root, it is practically impossible for the attacker to read the entire host disk via `/dev/rdiskN`. Also, practically, the attacker cannot read at least the first 512 bytes (MBR) of the target file. The issue has been patched in Lima in version 0.16.0 by prohibiting using a backing file path in the VM base image."
                }
            ],
            "source": {
                "advisory": "GHSA-f7qw-jj9c-rpq9",
                "discovery": "UNKNOWN"
            }
        }
    }
}