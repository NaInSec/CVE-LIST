{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-48705",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2023-11-17T19:43:37.554Z",
        "datePublished": "2023-11-22T15:15:06.189Z",
        "dateUpdated": "2023-11-22T15:15:06.189Z"
    },
    "containers": {
        "cna": {
            "title": "nautobot has XSS potential in custom links, job buttons, and computed fields",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-79",
                            "lang": "en",
                            "description": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "LOW",
                        "baseScore": 7.1,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:H/A:L",
                        "version": "3.1"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/nautobot/nautobot/security/advisories/GHSA-cf9f-wmhp-v4pr",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/nautobot/nautobot/security/advisories/GHSA-cf9f-wmhp-v4pr"
                },
                {
                    "name": "https://github.com/nautobot/nautobot/pull/4832",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/nautobot/nautobot/pull/4832"
                },
                {
                    "name": "https://github.com/nautobot/nautobot/pull/4833",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/nautobot/nautobot/pull/4833"
                },
                {
                    "name": "https://github.com/nautobot/nautobot/commit/362850f5a94689a4c75e3188bf6de826c3b012b2",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/nautobot/nautobot/commit/362850f5a94689a4c75e3188bf6de826c3b012b2"
                },
                {
                    "name": "https://github.com/nautobot/nautobot/commit/54abe23331b6c3d0d82bf1b028c679b1d200920d",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/nautobot/nautobot/commit/54abe23331b6c3d0d82bf1b028c679b1d200920d"
                },
                {
                    "name": "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.html.format_html",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.html.format_html"
                },
                {
                    "name": "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.safestring.mark_safe",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.safestring.mark_safe"
                }
            ],
            "affected": [
                {
                    "vendor": "nautobot",
                    "product": "nautobot",
                    "versions": [
                        {
                            "version": "< 1.6.6",
                            "status": "affected"
                        },
                        {
                            "version": ">= 2.0.0, < 2.0.5",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2023-11-22T15:15:06.189Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Nautobot is a Network Source of Truth and Network Automation Platform built as a web application All users of Nautobot versions earlier than 1.6.6 or 2.0.5 are potentially affected by a cross-site scripting vulnerability. Due to incorrect usage of Django's `mark_safe()` API when rendering certain types of user-authored content; including custom links, job buttons, and computed fields; it is possible that users with permission to create or edit these types of content could craft a malicious payload (such as JavaScript code) that would be executed when rendering pages containing this content. The maintainers have fixed the incorrect uses of `mark_safe()` (generally by replacing them with appropriate use of `format_html()` instead) to prevent such malicious data from being executed. Users on Nautobot 1.6.x LTM should upgrade to v1.6.6 and users on Nautobot 2.0.x should upgrade to v2.0.5. Appropriate object permissions can and should be applied to restrict which users are permitted to create or edit the aforementioned types of user-authored content. Other than that, there is no direct workaround available."
                }
            ],
            "source": {
                "advisory": "GHSA-cf9f-wmhp-v4pr",
                "discovery": "UNKNOWN"
            }
        }
    }
}