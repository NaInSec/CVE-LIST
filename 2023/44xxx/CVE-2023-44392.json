{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-44392",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2023-09-28T17:56:32.614Z",
        "datePublished": "2023-10-09T19:06:04.694Z",
        "dateUpdated": "2023-10-09T19:06:04.694Z"
    },
    "containers": {
        "cna": {
            "title": "Arbitrary code execution vulnerability when using shared Kubernetes cluster",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-94",
                            "lang": "en",
                            "description": "CWE-94: Improper Control of Generation of Code ('Code Injection')",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-502",
                            "lang": "en",
                            "description": "CWE-502: Deserialization of Untrusted Data",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 8.3,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
                        "version": "3.1"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/garden-io/garden/security/advisories/GHSA-hm75-6vc9-8rpr",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/garden-io/garden/security/advisories/GHSA-hm75-6vc9-8rpr"
                },
                {
                    "name": "https://github.com/garden-io/garden/commit/3117964da40d3114f129a6131b4ada89eaa4eb8c",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/garden-io/garden/commit/3117964da40d3114f129a6131b4ada89eaa4eb8c"
                }
            ],
            "affected": [
                {
                    "vendor": "garden-io",
                    "product": "garden",
                    "versions": [
                        {
                            "version": "< 0.12.65",
                            "status": "affected"
                        },
                        {
                            "version": ">= 0.13.0, < 0.13.17",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2023-10-09T19:06:04.694Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Garden provides automation for Kubernetes development and testing. Prior tov ersions 0.13.17 and 0.12.65, Garden has a dependency on the cryo library, which is vulnerable to code injection due to an insecure implementation of deserialization. Garden stores serialized objects using cryo in the Kubernetes `ConfigMap` resources prefixed with `test-result` and `run-result` to cache Garden test and run results. These `ConfigMaps` are stored either in the `garden-system` namespace or the configured user namespace. When a user invokes the command `garden test` or `garden run` objects stored in the `ConfigMap` are retrieved and deserialized. This can be used by an attacker with access to the Kubernetes cluster to store malicious objects in the `ConfigMap`, which can trigger a remote code execution on the users machine when cryo deserializes the object. In order to exploit this vulnerability, an attacker must have access to the Kubernetes cluster used to deploy garden remote environments. Further, a user must actively invoke either a `garden test` or `garden run` which has previously cached results. The issue has been patched in Garden versions `0.13.17` (Bonsai) and `0.12.65` (Acorn). Only Garden versions prior to these are vulnerable. No known workarounds are available."
                }
            ],
            "source": {
                "advisory": "GHSA-hm75-6vc9-8rpr",
                "discovery": "UNKNOWN"
            }
        }
    }
}