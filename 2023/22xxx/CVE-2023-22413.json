{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "state": "PUBLISHED",
        "cveId": "CVE-2023-22413",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "dateUpdated": "2023-01-12T00:00:00",
        "dateReserved": "2022-12-27T00:00:00",
        "datePublished": "2023-01-12T00:00:00"
    },
    "containers": {
        "cna": {
            "title": "Junos OS: MX Series: The Multiservices PIC Management Daemon (mspmand) will crash when an IPsec6 tunnel processes specific IPv4 packets",
            "datePublic": "2023-01-11T00:00:00",
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2023-01-12T00:00:00"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "An Improper Check or Handling of Exceptional Conditions vulnerability in the IPsec library of Juniper Networks Junos OS allows a network-based, unauthenticated attacker to cause Denial of Service (DoS). On all MX platforms with MS-MPC or MS-MIC card, when specific IPv4 packets are processed by an IPsec6 tunnel, the Multiservices PIC Management Daemon (mspmand) process will core and restart. This will lead to FPC crash. Traffic flow is impacted while mspmand restarts. Continued receipt of these specific packets will cause a sustained Denial of Service (DoS) condition. This issue only occurs if an IPv4 address is not configured on the multiservice interface. This issue affects: Juniper Networks Junos OS on MX Series All versions prior to 19.4R3-S9; 20.1 version 20.1R3-S5 and later versions; 20.2 versions prior to 20.2R3-S5; 20.3 versions prior to 20.3R3-S5; 20.4 versions prior to 20.4R3-S4; 21.1 versions prior to 21.1R3-S3; 21.2 versions prior to 21.2R3-S1; 21.3 versions prior to 21.3R3; 21.4 versions prior to 21.4R2-S1, 21.4R3; 22.1 versions prior to 22.1R2."
                }
            ],
            "affected": [
                {
                    "vendor": "Juniper Networks",
                    "product": "Junos OS",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "19.4R3-S9",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.2",
                            "status": "affected",
                            "lessThan": "20.2R3-S5",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.3",
                            "status": "affected",
                            "lessThan": "20.3R3-S5",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.4",
                            "status": "affected",
                            "lessThan": "20.4R3-S4",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.1",
                            "status": "affected",
                            "lessThan": "21.1R3-S3",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.2",
                            "status": "affected",
                            "lessThan": "21.2R3-S1",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3",
                            "status": "affected",
                            "lessThan": "21.3R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.4",
                            "status": "affected",
                            "lessThan": "21.4R2-S1, 21.4R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.1",
                            "status": "affected",
                            "lessThan": "22.1R2",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.1R3-S5 ",
                            "status": "affected",
                            "lessThan": "20.1*",
                            "versionType": "custom"
                        }
                    ],
                    "platforms": [
                        "MX Series"
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://kb.juniper.net/JSA70209"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-703 Improper Check or Handling of Exceptional Conditions",
                            "cweId": "CWE-703"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "type": "text",
                            "lang": "en",
                            "description": "Denial of Service (DoS)"
                        }
                    ]
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "source": {
                "advisory": "JSA70209",
                "defect": [
                    "1658671"
                ],
                "discovery": "USER"
            },
            "configurations": [
                {
                    "lang": "en",
                    "value": "The following minimal IPsec VPN configuration is required for this issue to be present.\n\n  [set services ipsec-vpn rule vpn_rule_ms_4_0_01 term term11 then dynamic ike-policy ike_policy_ms_4_0_0]\n  [set services ipsec-vpn rule vpn_rule_ms_4_0_01 term term11 then dynamic ipsec-policy ipsec_policy_ms_4_0_0]\n  [set services service-set ipsec_ss_ms_4_0_01 ipsec-vpn-options local-gateway 10.0.1.1]\n  [set services service-set ipsec_ss_ms_4_0_01 ipsec-vpn-rules vpn_rule_ms_4_0_01]"
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "In order to avoid this issue, configure a valid IPv4 address on the multiservice interface."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "The following software releases have been updated to resolve this specific issue: 19.4R3-S9, 20.2R3-S5, 20.3R3-S5, 20.4R3-S4, 21.1R3-S3, 21.2R3-S1, 21.3R3, 21.4R3, 22.1R2, 22.2R1, and all subsequent releases.\n"
                }
            ]
        }
    }
}