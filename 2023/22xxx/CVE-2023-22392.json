{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-22392",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "state": "PUBLISHED",
        "assignerShortName": "juniper",
        "dateReserved": "2022-12-27T16:52:14.098Z",
        "datePublished": "2023-10-12T22:55:42.016Z",
        "dateUpdated": "2023-10-23T19:10:26.391Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "PTX1000",
                        "PTX10002",
                        "PTX10004",
                        "PTX10008",
                        "PTX10016 with LC110x FPCs"
                    ],
                    "product": "Junos OS",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "20.4R3-S5",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.1R3-S4",
                            "status": "affected",
                            "version": "21.1",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.2R3-S2",
                            "status": "affected",
                            "version": "21.2",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.3R3",
                            "status": "affected",
                            "version": "21.3",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.4R2-S2, 21.4R3",
                            "status": "affected",
                            "version": "21.4",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.1R1-S2, 22.1R2",
                            "status": "affected",
                            "version": "22.1",
                            "versionType": "semver"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "PTX3000",
                        "PTX5000",
                        "QFX10000"
                    ],
                    "product": "Junos OS",
                    "vendor": "Juniper Networks",
                    "versions": [
                        {
                            "lessThan": "20.4R3-S8",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.1*",
                            "status": "affected",
                            "version": "21.1R1",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.2R3-S6",
                            "status": "affected",
                            "version": "21.2",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.3R3-S5",
                            "status": "affected",
                            "version": "21.3",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "21.4R3-S4",
                            "status": "affected",
                            "version": "21.4",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.1R3-S3",
                            "status": "affected",
                            "version": "22.1",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.2R3-S1",
                            "status": "affected",
                            "version": "22.2",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.3R2-S2, 22.3R3",
                            "status": "affected",
                            "version": "22.3",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "22.4R2",
                            "status": "affected",
                            "version": "22.4",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>The following configuration is affected by this issue:</p> <tt>[protocols bgp group family flow]</tt>"
                        }
                    ],
                    "value": "The following configuration is affected by this issue:\n\n [protocols bgp group family flow]"
                }
            ],
            "datePublic": "2023-10-11T16:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "\n\n<p>A Missing Release of Memory after Effective Lifetime vulnerability in the Packet Forwarding Engine (PFE) of Juniper Networks Junos OS allows an adjacent, unauthenticated attacker to cause a Denial of Service (DoS).</p><p>PTX3000, PTX5000, QFX10000, PTX1000, PTX10002, and PTX10004, PTX10008 and PTX10016 with LC110x FPCs do not support certain flow-routes. Once a flow-route is received over an established BGP session and an attempt is made to install the resulting filter into the PFE, FPC heap memory is leaked. The FPC heap memory can be monitored using the CLI command \"show chassis fpc\".</p><p>The following syslog messages can be observed if the respective filter derived from a flow-route cannot be installed.</p><code>expr_dfw_sfm_range_add:661 SFM packet-length Unable to get a sfm entry for updating the hw</code><br><code>expr_dfw_hw_sfm_add:750 Unable to add the filter secondarymatch to the hardware</code><br><code>expr_dfw_base_hw_add:52 Failed to add h/w sfm data.</code><br><code>expr_dfw_base_hw_create:114 Failed to add h/w data.</code><br><code>expr_dfw_base_pfe_inst_create:241 Failed to create base inst for sfilter 0 on PFE 0 for __flowspec_default_inet__</code><br><code>expr_dfw_flt_inst_change:1368 Failed to create __flowspec_default_inet__ on PFE 0</code><br><code>expr_dfw_hw_pgm_fnum:465 dfw_pfe_inst_old not found for pfe_index 0!</code><br><code>expr_dfw_bp_pgm_flt_num:548 Failed to pgm bind-point in hw: generic failure</code><br><code>expr_dfw_bp_topo_handler:1102 Failed to program fnum.</code><br><code>expr_dfw_entry_process_change:679 Failed to change instance for filter __flowspec_default_inet__.</code><br><p>This issue affects Juniper Networks Junos OS:</p><p>on PTX1000, PTX10002, and PTX10004, PTX10008 and PTX10016 with LC110x FPCs:</p><p></p><ul><li>All versions prior to 20.4R3-S5;</li><li>21.1 versions prior to 21.1R3-S4;</li><li>21.2 versions prior to 21.2R3-S2;</li><li>21.3 versions prior to 21.3R3;</li><li>21.4 versions prior to 21.4R2-S2, 21.4R3;</li><li>22.1 versions prior to 22.1R1-S2, 22.1R2.</li></ul><p></p><p>on PTX3000, PTX5000, QFX10000:</p><p></p><ul><li>All versions prior to 20.4R3-S8;</li><li>21.1 version 21.1R1 and later versions;</li><li>21.2 versions prior to 21.2R3-S6;</li><li>21.3 versions prior to 21.3R3-S5;</li><li>21.4 versions prior to 21.4R3-S4;</li><li>22.1 versions prior to 22.1R3-S3</li><li>22.2 versions prior to 22.2R3-S1</li><li>22.3 versions prior to 22.3R2-S2, 22.3R3</li><li>22.4 versions prior to 22.4R2.</li></ul><p></p>\n\n"
                        }
                    ],
                    "value": "\nA Missing Release of Memory after Effective Lifetime vulnerability in the Packet Forwarding Engine (PFE) of Juniper Networks Junos OS allows an adjacent, unauthenticated attacker to cause a Denial of Service (DoS).\n\nPTX3000, PTX5000, QFX10000, PTX1000, PTX10002, and PTX10004, PTX10008 and PTX10016 with LC110x FPCs do not support certain flow-routes. Once a flow-route is received over an established BGP session and an attempt is made to install the resulting filter into the PFE, FPC heap memory is leaked. The FPC heap memory can be monitored using the CLI command \"show chassis fpc\".\n\nThe following syslog messages can be observed if the respective filter derived from a flow-route cannot be installed.\n\nexpr_dfw_sfm_range_add:661 SFM packet-length Unable to get a sfm entry for updating the hw\nexpr_dfw_hw_sfm_add:750 Unable to add the filter secondarymatch to the hardware\nexpr_dfw_base_hw_add:52 Failed to add h/w sfm data.\nexpr_dfw_base_hw_create:114 Failed to add h/w data.\nexpr_dfw_base_pfe_inst_create:241 Failed to create base inst for sfilter 0 on PFE 0 for __flowspec_default_inet__\nexpr_dfw_flt_inst_change:1368 Failed to create __flowspec_default_inet__ on PFE 0\nexpr_dfw_hw_pgm_fnum:465 dfw_pfe_inst_old not found for pfe_index 0!\nexpr_dfw_bp_pgm_flt_num:548 Failed to pgm bind-point in hw: generic failure\nexpr_dfw_bp_topo_handler:1102 Failed to program fnum.\nexpr_dfw_entry_process_change:679 Failed to change instance for filter __flowspec_default_inet__.\nThis issue affects Juniper Networks Junos OS:\n\non PTX1000, PTX10002, and PTX10004, PTX10008 and PTX10016 with LC110x FPCs:\n\n\n\n  *  All versions prior to 20.4R3-S5;\n  *  21.1 versions prior to 21.1R3-S4;\n  *  21.2 versions prior to 21.2R3-S2;\n  *  21.3 versions prior to 21.3R3;\n  *  21.4 versions prior to 21.4R2-S2, 21.4R3;\n  *  22.1 versions prior to 22.1R1-S2, 22.1R2.\n\n\n\n\non PTX3000, PTX5000, QFX10000:\n\n\n\n  *  All versions prior to 20.4R3-S8;\n  *  21.1 version 21.1R1 and later versions;\n  *  21.2 versions prior to 21.2R3-S6;\n  *  21.3 versions prior to 21.3R3-S5;\n  *  21.4 versions prior to 21.4R3-S4;\n  *  22.1 versions prior to 22.1R3-S3\n  *  22.2 versions prior to 22.2R3-S1\n  *  22.3 versions prior to 22.3R2-S2, 22.3R3\n  *  22.4 versions prior to 22.4R2.\n\n\n\n\n\n\n"
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>Juniper SIRT is not aware of any malicious exploitation of this vulnerability.</p>"
                        }
                    ],
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability.\n\n"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "ADJACENT_NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-401",
                            "description": "CWE-401 A Missing Release of Memory after Effective Lifetime",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "description": "Denial of Service (DoS)",
                            "lang": "en"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2023-10-23T19:10:26.391Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://supportportal.juniper.net/JSA73530"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>The following software releases have been updated to resolve this specific issue: </p><p>For PTX1000, PTX10002, and PTX10004, PTX10008 and PTX10016 with LC110x FPCs: Junos OS 20.4R3-S5, 21.1R3-S4, 21.2R3-S2, 21.3R3, 21.4R2-S2, 21.4R3, 22.1R1-S2, 22.1R2, 22.2R1, and all subsequent releases.</p><p>For PTX3000, PTX5000, QFX10000: Junos OS 20.4R3-S8, 21.2R3-S6, 21.3R3-S5, 21.4R3-S4, 22.1R3-S3, 22.2R3-S1, 22.3R2-S2, 22.3R3, 22.4R2, 23.2R1, and all subsequent releases.</p>"
                        }
                    ],
                    "value": "The following software releases have been updated to resolve this specific issue: \n\nFor PTX1000, PTX10002, and PTX10004, PTX10008 and PTX10016 with LC110x FPCs: Junos OS 20.4R3-S5, 21.1R3-S4, 21.2R3-S2, 21.3R3, 21.4R2-S2, 21.4R3, 22.1R1-S2, 22.1R2, 22.2R1, and all subsequent releases.\n\nFor PTX3000, PTX5000, QFX10000: Junos OS 20.4R3-S8, 21.2R3-S6, 21.3R3-S5, 21.4R3-S4, 22.1R3-S3, 22.2R3-S1, 22.3R2-S2, 22.3R3, 22.4R2, 23.2R1, and all subsequent releases.\n\n"
                }
            ],
            "source": {
                "advisory": "JSA73530",
                "defect": [
                    "1650443",
                    "1716398"
                ],
                "discovery": "USER"
            },
            "timeline": [
                {
                    "lang": "en",
                    "time": "2023-10-11T16:00:00.000Z",
                    "value": "Initial Publication"
                },
                {
                    "lang": "en",
                    "time": "2023-11-23T17:00:00.000Z",
                    "value": "Corrected vendor-advisory reference URL"
                }
            ],
            "title": "Junos OS: PTX Series and QFX10000 Series: Received flow-routes which aren't installed as the hardware doesn't support them, lead to an FPC heap memory leak",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>There are no known workarounds for this issue.</p>"
                        }
                    ],
                    "value": "There are no known workarounds for this issue.\n\n"
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.1.0-av217"
            }
        }
    }
}