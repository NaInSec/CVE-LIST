{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-46667",
        "assignerOrgId": "271b6943-45a9-4f3a-ab4e-976f3fa05b5a",
        "state": "PUBLISHED",
        "assignerShortName": "elastic",
        "dateReserved": "2023-10-24T17:28:32.185Z",
        "datePublished": "2023-10-26T00:59:36.713Z",
        "dateUpdated": "2023-10-26T00:59:36.713Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Fleet Server",
                    "vendor": "Elastic",
                    "versions": [
                        {
                            "lessThan": "8.10.3",
                            "status": "affected",
                            "version": "8.10.0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "datePublic": "2023-10-10T12:46:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "An issue was discovered in Fleet Server &gt;= v8.10.0 and &lt; v8.10.3 where Agent enrolment tokens are being inserted into the Fleet Serverâ€™s log file in plain text. These enrolment tokens could allow someone to enrol an agent into an agent policy, and potentially use that to retrieve other secrets in the policy including for Elasticsearch and third-party services. Alternatively a threat actor could potentially enrol agents to the clusters and send arbitrary events to Elasticsearch."
                        }
                    ],
                    "value": "An issue was discovered in Fleet Server >= v8.10.0 and < v8.10.3 where Agent enrolment tokens are being inserted into the Fleet Serverâ€™s log file in plain text. These enrolment tokens could allow someone to enrol an agent into an agent policy, and potentially use that to retrieve other secrets in the policy including for Elasticsearch and third-party services. Alternatively a threat actor could potentially enrol agents to the clusters and send arbitrary events to Elasticsearch."
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 8.1,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-532",
                            "description": "CWE-532: Insertion of Sensitive Information into Log File",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "271b6943-45a9-4f3a-ab4e-976f3fa05b5a",
                "shortName": "elastic",
                "dateUpdated": "2023-10-26T00:59:36.713Z"
            },
            "references": [
                {
                    "url": "https://discuss.elastic.co/t/fleet-server-v8-10-3-security-update/344737"
                },
                {
                    "url": "https://www.elastic.co/community/security"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Fleet Server Insertion of Sensitive Information into Log File",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}