{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-46836",
        "assignerOrgId": "23aa2041-22e1-471f-9209-9b7396fa234f",
        "state": "PUBLISHED",
        "assignerShortName": "XEN",
        "dateReserved": "2023-10-27T07:55:35.332Z",
        "datePublished": "2024-01-05T16:34:59.036Z",
        "dateUpdated": "2024-01-05T16:34:59.036Z"
    },
    "containers": {
        "cna": {
            "title": "x86: BTC/SRSO fixes not fully effective",
            "datePublic": "2023-11-14T12:00:00Z",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "The fixes for XSA-422 (Branch Type Confusion) and XSA-434 (Speculative\nReturn Stack Overflow) are not IRQ-safe.  It was believed that the\nmitigations always operated in contexts with IRQs disabled.\n\nHowever, the original XSA-254 fix for Meltdown (XPTI) deliberately left\ninterrupts enabled on two entry paths; one unconditionally, and one\nconditionally on whether XPTI was active.\n\nAs BTC/SRSO and Meltdown affect different CPU vendors, the mitigations\nare not active together by default.  Therefore, there is a race\ncondition whereby a malicious PV guest can bypass BTC/SRSO protections\nand launch a BTC/SRSO attack against Xen.\n"
                }
            ],
            "impacts": [
                {
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "An attacker in a PV guest might be able to infer the contents of memory\nbelonging to other guests.\n"
                        }
                    ]
                }
            ],
            "affected": [
                {
                    "defaultStatus": "unknown",
                    "product": "Xen",
                    "vendor": "Xen",
                    "versions": [
                        {
                            "status": "unknown",
                            "version": "consult Xen advisory XSA-446"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "value": "All versions of Xen are vulnerable.\n\nXen is only vulnerable in default configurations on AMD and Hygon CPUs.\n\nXen is not believed to be vulnerable in default configurations on CPUs\nfrom other hardware vendors.\n\nOnly PV guests can leverage the vulnerability.\n"
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "Running only HVM or PVH VMs will avoid the vulnerability.\n"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "This issue was discovered by Andrew Cooper of XenServer.\n"
                }
            ],
            "references": [
                {
                    "url": "https://xenbits.xenproject.org/xsa/advisory-446.html"
                }
            ],
            "providerMetadata": {
                "orgId": "23aa2041-22e1-471f-9209-9b7396fa234f",
                "shortName": "XEN",
                "dateUpdated": "2024-01-05T16:34:59.036Z"
            }
        }
    }
}