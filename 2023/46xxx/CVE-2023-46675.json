{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-46675",
        "assignerOrgId": "271b6943-45a9-4f3a-ab4e-976f3fa05b5a",
        "state": "PUBLISHED",
        "assignerShortName": "elastic",
        "dateReserved": "2023-10-24T17:28:32.186Z",
        "datePublished": "2023-12-13T07:02:07.706Z",
        "dateUpdated": "2023-12-13T07:02:07.706Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Kibana",
                    "vendor": "Elastic",
                    "versions": [
                        {
                            "lessThan": "7.17.16",
                            "status": "affected",
                            "version": "7.13.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "8.11.2",
                            "status": "affected",
                            "version": "8.0.0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "datePublic": "2023-12-12T17:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<span style=\"background-color: rgba(70, 149, 74, 0.15);\">An</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">issue</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\"> was discovered by Elastic whereby sensitive information may be recorded in Kibana logs in the event of an error or in the event where debug level logging is enabled in </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">Kibana</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">. </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">Elastic</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\"> has released Kibana 8.11.2 which resolves this issue. The messages recorded in the log may contain Account credentials for the kibana_system user, API Keys, and credentials of Kibana end-users, Elastic Security package policy objects which can contain private keys, bearer token, and sessions of 3rd-party integrations and finally Authorization headers, client </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">secrets</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">, local file paths, and stack traces. The issue may occur in any Kibana instance running an affected version that could potentially receive an unexpected error when </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">communicating</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\"> to Elasticsearch causing it to include </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">sensitive</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">data</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">into</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\"> Kibana error logs. It could also occur under specific circumstances when debug level logging is enabled in Kibana. </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">Note</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">: </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">It</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">was</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">found</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">that</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">the</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">fix</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\"> for </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">ESA</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">-</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">2023</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">-25 in Kibana </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">8</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">.11.1 for </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">a</span> <span style=\"background-color: rgba(70, 149, 74, 0.15);\">similar</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\"> issue was </span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">incomplete</span><span style=\"background-color: rgba(70, 149, 74, 0.15);\">.</span><br>"
                        }
                    ],
                    "value": "An issue was discovered by Elastic whereby sensitive information may be recorded in Kibana logs in the event of an error or in the event where debug level logging is enabled in Kibana. Elastic has released Kibana 8.11.2 which resolves this issue. The messages recorded in the log may contain Account credentials for the kibana_system user, API Keys, and credentials of Kibana end-users, Elastic Security package policy objects which can contain private keys, bearer token, and sessions of 3rd-party integrations and finally Authorization headers, client secrets, local file paths, and stack traces. The issue may occur in any Kibana instance running an affected version that could potentially receive an unexpected error when communicating to Elasticsearch causing it to include sensitive data into Kibana error logs. It could also occur under specific circumstances when debug level logging is enabled in Kibana. Note: It was found that the fix for ESA-2023-25 in Kibana 8.11.1 for a similar issue was incomplete.\n"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "HIGH",
                        "attackVector": "ADJACENT_NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-532",
                            "description": "CWE-532 Insertion of Sensitive Information into Log File",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "271b6943-45a9-4f3a-ab4e-976f3fa05b5a",
                "shortName": "elastic",
                "dateUpdated": "2023-12-13T07:02:07.706Z"
            },
            "references": [
                {
                    "url": "https://discuss.elastic.co/t/kibana-8-11-2-7-17-16-security-update-esa-2023-27/349182/2"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Kibana Insertion of Sensitive Information into Log File",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}