{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-40195",
        "assignerOrgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
        "state": "PUBLISHED",
        "assignerShortName": "apache",
        "dateReserved": "2023-08-10T09:26:47.223Z",
        "datePublished": "2023-08-28T07:50:01.211Z",
        "dateUpdated": "2023-08-28T07:50:01.211Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Apache Airflow Spark Provider",
                    "vendor": "Apache Software Foundation",
                    "versions": [
                        {
                            "lessThan": "4.1.3",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "happyhacking-k"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Deserialization of Untrusted Data, Inclusion of Functionality from Untrusted Control Sphere vulnerability in Apache Software Foundation Apache Airflow Spark Provider.<br><br><br><span style=\"background-color: rgb(255, 255, 255);\">When the Apache Spark provider is installed on an Airflow deployment, an Airflow user that is authorized to configure Spark hooks can effectively run arbitrary code on the Airflow node by pointing it at a malicious Spark server. Prior to version 4.1.3, this was not called out in the documentation explicitly, so it is possible that administrators provided authorizations to configure Spark hooks without taking this into account. We recommend administrators to review their configurations to make sure the authorization to configure Spark hooks is only provided to fully trusted users.<br><br>To view the warning in the docs please visit&nbsp;<a target=\"_blank\" rel=\"nofollow\" href=\"https://airflow.apache.org/docs/apache-airflow-providers-apache-spark/4.1.3/connections/spark.html\">https://airflow.apache.org/docs/apache-airflow-providers-apache-spark/4.1.3/connections/spark.html</a><br><br><br></span>"
                        }
                    ],
                    "value": "Deserialization of Untrusted Data, Inclusion of Functionality from Untrusted Control Sphere vulnerability in Apache Software Foundation Apache Airflow Spark Provider.\n\nWhen the Apache Spark provider is installed on an Airflow deployment, an Airflow user that is authorized to configure Spark hooks can effectively run arbitrary code on the Airflow node by pointing it at a malicious Spark server. Prior to version 4.1.3, this was not called out in the documentation explicitly, so it is possible that administrators provided authorizations to configure Spark hooks without taking this into account. We recommend administrators to review their configurations to make sure the authorization to configure Spark hooks is only provided to fully trusted users.\n\nTo view the warning in the docs please visitÂ  https://airflow.apache.org/docs/apache-airflow-providers-apache-spark/4.1.3/connections/spark.html \n\n"
                }
            ],
            "metrics": [
                {
                    "other": {
                        "content": {
                            "text": "moderate"
                        },
                        "type": "Textual description of severity"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-502",
                            "description": "CWE-502 Deserialization of Untrusted Data",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-829",
                            "description": "CWE-829 Inclusion of Functionality from Untrusted Control Sphere",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
                "shortName": "apache",
                "dateUpdated": "2023-08-28T07:50:01.211Z"
            },
            "references": [
                {
                    "tags": [
                        "patch"
                    ],
                    "url": "https://github.com/apache/airflow/pull/33233"
                },
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://lists.apache.org/thread/fzy95b1d6zv31j5wrx3znhzcscck2o24"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Apache Airflow Spark Provider Deserialization Vulnerability RCE",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}