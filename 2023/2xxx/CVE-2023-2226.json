{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-2226",
        "assignerOrgId": "9974b330-7714-4307-a722-5648477acda7",
        "state": "PUBLISHED",
        "assignerShortName": "rapid7",
        "dateReserved": "2023-04-21T11:40:07.131Z",
        "datePublished": "2023-04-21T11:48:46.279Z",
        "dateUpdated": "2023-04-21T11:48:46.279Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://github.com/Velocidex/velociraptor/releases",
                    "defaultStatus": "unaffected",
                    "modules": [
                        "PE Parser",
                        "OLE parser",
                        "Authenticode parser"
                    ],
                    "packageName": "Velociraptor",
                    "platforms": [
                        "Windows"
                    ],
                    "product": "Velociraptor",
                    "repo": "https://github.com/Velocidex/velociraptor/",
                    "vendor": "Rapid7",
                    "versions": [
                        {
                            "lessThan": "0.6.8",
                            "status": "affected",
                            "version": "0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "reporter",
                    "user": "00000000-0000-4000-9000-000000000000",
                    "value": "Thanks to b1tg https://github.com/b1tg for reporting these issues and providing samples that trigger the crashes"
                }
            ],
            "datePublic": "2023-04-21T11:45:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Due to insufficient validation in the PE and OLE parsers in Rapid7's Velociraptor versions earlier than 0.6.8 allows attacker to crash Velociraptor during parsing of maliciously malformed files.&nbsp;<br><br>For this attack to succeed, the attacker needs to be able to introduce malicious files to the system at the same time that Velociraptor attempts to collect any artifacts that attempt to parse PE files, Authenticode signatures, or OLE files. After crashing, the Velociraptor service will restart and it will still be possible to collect other artifacts.<br><br>"
                        }
                    ],
                    "value": "Due to insufficient validation in the PE and OLE parsers in Rapid7's Velociraptor versions earlier than 0.6.8 allows attacker to crash Velociraptor during parsing of maliciously malformed files.Â \n\nFor this attack to succeed, the attacker needs to be able to introduce malicious files to the system at the same time that Velociraptor attempts to collect any artifacts that attempt to parse PE files, Authenticode signatures, or OLE files. After crashing, the Velociraptor service will restart and it will still be possible to collect other artifacts.\n\n"
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-540",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-540 Overread Buffers"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "LOW",
                        "baseScore": 3.3,
                        "baseSeverity": "LOW",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "REQUIRED",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-125",
                            "description": "CWE-125 Out-of-bounds Read",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "9974b330-7714-4307-a722-5648477acda7",
                "shortName": "rapid7",
                "dateUpdated": "2023-04-21T11:48:46.279Z"
            },
            "references": [
                {
                    "url": "https://github.com/Velocidex/velociraptor"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Upgrade the clients to version 0.6.8-2"
                        }
                    ],
                    "value": "Upgrade the clients to version 0.6.8-2"
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "title": "Velociraptor crashes while parsing some malformed PE or OLE files.",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}