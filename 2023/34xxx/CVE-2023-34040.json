{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-34040",
        "assignerOrgId": "dcf2e128-44bd-42ed-91e8-88f912c1401d",
        "state": "PUBLISHED",
        "assignerShortName": "vmware",
        "dateReserved": "2023-05-25T17:21:56.201Z",
        "datePublished": "2023-08-24T12:59:20.620Z",
        "dateUpdated": "2023-08-24T12:59:20.620Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Spring For Apache Kafka",
                    "vendor": "Spring",
                    "versions": [
                        {
                            "lessThan": "2.9.11",
                            "status": "affected",
                            "version": "2.8.x",
                            "versionType": "2.9.11"
                        },
                        {
                            "lessThan": "2.9.11",
                            "status": "affected",
                            "version": "2.9.x",
                            "versionType": "2.9.11"
                        },
                        {
                            "lessThan": "3.0.10",
                            "status": "affected",
                            "version": "3.0.x",
                            "versionType": "3.0.10"
                        }
                    ]
                }
            ],
            "datePublic": "2023-08-23T14:59:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>In Spring for Apache Kafka 3.0.9 and earlier and versions 2.9.10 and earlier, a possible deserialization attack vector existed, but only if unusual configuration was applied. An attacker would have to construct a malicious serialized object in one of the deserialization exception record headers.<br><br>Specifically, an application is vulnerable when all of the following are true:</p><ul><li>The user does <b>not</b>&nbsp;configure an ErrorHandlingDeserializer for the key and/or value of the record</li><li>The user explicitly sets container properties checkDeserExWhenKeyNull and/or checkDeserExWhenValueNull container properties to true.</li><li>The user allows untrusted sources to publish to a Kafka topic</li></ul><p>By default, these properties are false, and the container only attempts to deserialize the headers if an ErrorHandlingDeserializer is configured. The ErrorHandlingDeserializer prevents the vulnerability by removing any such malicious headers before processing the record.</p><br>"
                        }
                    ],
                    "value": "In Spring for Apache Kafka 3.0.9 and earlier and versions 2.9.10 and earlier, a possible deserialization attack vector existed, but only if unusual configuration was applied. An attacker would have to construct a malicious serialized object in one of the deserialization exception record headers.\n\nSpecifically, an application is vulnerable when all of the following are true:\n\n  *  The user does notÂ configure an ErrorHandlingDeserializer for the key and/or value of the record\n  *  The user explicitly sets container properties checkDeserExWhenKeyNull and/or checkDeserExWhenValueNull container properties to true.\n  *  The user allows untrusted sources to publish to a Kafka topic\n\n\nBy default, these properties are false, and the container only attempts to deserialize the headers if an ErrorHandlingDeserializer is configured. The ErrorHandlingDeserializer prevents the vulnerability by removing any such malicious headers before processing the record.\n\n\n"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "LOW",
                        "baseScore": 5.3,
                        "baseSeverity": "MEDIUM",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-502",
                            "description": "CWE-502 Deserialization of Untrusted Data",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "dcf2e128-44bd-42ed-91e8-88f912c1401d",
                "shortName": "vmware",
                "dateUpdated": "2023-08-24T12:59:20.620Z"
            },
            "references": [
                {
                    "url": "https://spring.io/security/cve-2023-34040"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Java Deserialization vulnerability in Spring-Kafka When Improperly Configured",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}