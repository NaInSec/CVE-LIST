{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-34328",
        "assignerOrgId": "23aa2041-22e1-471f-9209-9b7396fa234f",
        "state": "PUBLISHED",
        "assignerShortName": "XEN",
        "dateReserved": "2023-06-01T10:44:17.066Z",
        "datePublished": "2024-01-05T16:34:11.100Z",
        "dateUpdated": "2024-01-05T16:34:11.100Z"
    },
    "containers": {
        "cna": {
            "title": "x86/AMD: Debug Mask handling",
            "datePublic": "2023-10-10T12:00:00Z",
            "descriptions": [
                {
                    "lang": "en",
                    "value": "\n[This CNA information record relates to multiple CVEs; the\ntext explains which aspects/vulnerabilities correspond to which CVE.]\n\nAMD CPUs since ~2014 have extensions to normal x86 debugging functionality.\nXen supports guests using these extensions.\n\nUnfortunately there are errors in Xen's handling of the guest state, leading\nto denials of service.\n\n 1) CVE-2023-34327 - An HVM vCPU can end up operating in the context of\n    a previous vCPUs debug mask state.\n\n 2) CVE-2023-34328 - A PV vCPU can place a breakpoint over the live GDT.\n    This allows the PV vCPU to exploit XSA-156 / CVE-2015-8104 and lock\n    up the CPU entirely.\n"
                }
            ],
            "impacts": [
                {
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "For CVE-2023-34327, any guest (PV or HVM) using Debug Masks normally for\nit's own purposes can cause incorrect behaviour in an unrelated HVM\nvCPU, most likely resulting in a guest crash.\n\nFor CVE-2023-34328, a buggy or malicious PV guest kernel can lock up the\nhost.\n"
                        }
                    ]
                }
            ],
            "affected": [
                {
                    "defaultStatus": "unknown",
                    "product": "Xen",
                    "vendor": "Xen",
                    "versions": [
                        {
                            "status": "unknown",
                            "version": "consult Xen advisory XSA-444"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "value": "Only AMD/Hygon hardware supporting the DBEXT feature are vulnerable.\nThis is believed to be the Steamroller microarchitecture and later.\n\nFor CVE-2023-34327, Xen versions 4.5 and later are vulnerable.\n\nFor CVE-2023-34328, Xen version between 4.5 and 4.13 are vulnerable.\nThe issue is benign in Xen 4.14 and later owing to an unrelated change.\n"
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "For CVE-2023-34327, HVM VMs which can see the DBEXT feature are not\nsusceptible to running in the wrong state.  By default, VMs will see the\nDBEXT feature on capable hardware, and when not explicitly levelled for\nmigration compatibility.\n\nFor CVE-2023-34328, PV VMs which cannot see the DBEXT feature cannot\nleverage the vulnerability.\n"
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "This issue was discovered by Andrew Cooper of XenServer.\n"
                }
            ],
            "references": [
                {
                    "url": "https://xenbits.xenproject.org/xsa/advisory-444.html"
                }
            ],
            "providerMetadata": {
                "orgId": "23aa2041-22e1-471f-9209-9b7396fa234f",
                "shortName": "XEN",
                "dateUpdated": "2024-01-05T16:34:11.100Z"
            }
        }
    }
}