{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-34253",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2023-05-31T13:51:51.175Z",
        "datePublished": "2023-06-14T22:00:12.569Z",
        "dateUpdated": "2023-06-14T22:16:52.675Z"
    },
    "containers": {
        "cna": {
            "title": "Grav vulnerable to Server-side Template Injection (SSTI) via Denylist Bypass",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-184",
                            "lang": "en",
                            "description": "CWE-184: Incomplete List of Disallowed Inputs",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-1336",
                            "lang": "en",
                            "description": "CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 8.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm"
                },
                {
                    "name": "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b"
                },
                {
                    "name": "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190"
                },
                {
                    "name": "https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/"
                },
                {
                    "name": "https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83"
                }
            ],
            "affected": [
                {
                    "vendor": "getgrav",
                    "product": "grav",
                    "versions": [
                        {
                            "version": "< 1.7.42",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2023-06-14T22:16:52.675Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Grav is a flat-file content management system. Prior to version 1.7.42, the denylist introduced in commit 9d6a2d to prevent dangerous functions from being executed via injection of malicious templates was insufficient and could be easily subverted in multiple ways -- (1) using unsafe functions that are not banned, (2) using capitalised callable names, and (3) using fully-qualified names for referencing callables. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. A patch in version 1.7.42 improves the denylist."
                }
            ],
            "source": {
                "advisory": "GHSA-j3v8-v77f-fvgm",
                "discovery": "UNKNOWN"
            }
        }
    }
}