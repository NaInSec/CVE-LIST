{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-6837",
        "assignerOrgId": "ed10eef1-636d-4fbe-9993-6890dfa878f8",
        "state": "PUBLISHED",
        "assignerShortName": "WSO2",
        "dateReserved": "2023-12-15T09:40:50.666Z",
        "datePublished": "2023-12-15T09:41:22.719Z",
        "dateUpdated": "2024-02-07T05:36:55.643Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "WSO2 API Manager",
                    "repo": "https://github.com/wso2/product-apim",
                    "vendor": "WSO2",
                    "versions": [
                        {
                            "lessThan": "2.5.0.0",
                            "status": "unknown",
                            "version": "0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "2.5.0.32",
                            "status": "affected",
                            "version": "2.5.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "2.6.0.52",
                            "status": "affected",
                            "version": "2.6.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "3.0.0.50",
                            "status": "affected",
                            "version": "3.0.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "3.1.0.72",
                            "status": "affected",
                            "version": "3.1.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "3.2.0.86",
                            "status": "affected",
                            "version": "3.2.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "4.0.0.35",
                            "status": "affected",
                            "version": "4.0.0.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "product": "WSO2 Identity Server",
                    "repo": "https://github.com/wso2/product-is",
                    "vendor": "WSO2",
                    "versions": [
                        {
                            "lessThan": "5.6.0.0",
                            "status": "unknown",
                            "version": "0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.6.0.16",
                            "status": "affected",
                            "version": "5.6.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.7.0.35",
                            "status": "affected",
                            "version": "5.7.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.8.0.26",
                            "status": "affected",
                            "version": "5.8.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.9.0.38",
                            "status": "affected",
                            "version": "5.9.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.10.0.78",
                            "status": "affected",
                            "version": "5.10.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.11.0.69",
                            "status": "affected",
                            "version": "5.11.0.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unaffected",
                    "product": "WSO2 IS as Key Manager",
                    "vendor": "WSO2",
                    "versions": [
                        {
                            "lessThan": "5.6.0.0",
                            "status": "unknown",
                            "version": "0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.6.0.17",
                            "status": "affected",
                            "version": "5.6.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.7.0.39",
                            "status": "affected",
                            "version": "5.7.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.9.0.45",
                            "status": "affected",
                            "version": "5.9.0.0",
                            "versionType": "custom"
                        },
                        {
                            "lessThan": "5.10.0.80",
                            "status": "affected",
                            "version": "5.10.0.0",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "defaultStatus": "unknown",
                    "packageName": "org.wso2.carbon.identity.framework:org.wso2.carbon.identity.application.authentication.endpoint.util",
                    "product": "WSO2 Carbon Identity Application Authentication Endpoint(Utils)",
                    "repo": "https://github.com/wso2/identity-apps",
                    "vendor": "WSO2",
                    "versions": [
                        {
                            "lessThan": "5.11.256.*",
                            "status": "unaffected",
                            "version": "5.11.256.3",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.12.153.*",
                            "status": "unaffected",
                            "version": "5.12.153.19",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.12.387.*",
                            "status": "unaffected",
                            "version": "5.12.387.7",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.12.153.*",
                            "status": "unaffected",
                            "version": "5.12.153.21",
                            "versionType": "maven"
                        },
                        {
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "version": "5.20.254",
                            "versionType": "maven"
                        }
                    ]
                },
                {
                    "defaultStatus": "unknown",
                    "packageName": "org.wso2.carbon.identity.framework:org.wso2.carbon.identity.application.authentication.framework",
                    "product": "WSO2 Carbon Identity Application Authentication Framework",
                    "repo": "https://github.com/wso2/carbon-identity-framework",
                    "vendor": "WSO2",
                    "versions": [
                        {
                            "lessThan": "5.11.256.*",
                            "status": "unaffected",
                            "version": "5.11.256.3",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.12.153.*",
                            "status": "unaffected",
                            "version": "5.12.153.21",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.12.387.*",
                            "status": "unaffected",
                            "version": "5.12.387.7",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.14.97.*",
                            "status": "unaffected",
                            "version": "5.14.97.22",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.17.5.*",
                            "status": "unaffected",
                            "version": "5.17.5.106",
                            "versionType": "maven"
                        },
                        {
                            "lessThan": "5.18.187.*",
                            "status": "unaffected",
                            "version": "5.18.187.76",
                            "versionType": "maven"
                        },
                        {
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "version": "5.20.254",
                            "versionType": "maven"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Multiple WSO2 products have been identified as vulnerable to perform user impersonatoin using JIT provisioning.&nbsp;<p>In order for this vulnerability to have any impact on your deployment, following conditions must be met:</p><ul><li>An IDP configured for federated authentication and JIT provisioning enabled with the \"Prompt for username, password and consent\" option.</li><li>A service provider that uses the above IDP for federated authentication and has the \"Assert identity using mapped local subject identifier\" flag enabled.</li></ul><p>Attacker should have:</p><ul><li>A fresh valid user account in the federated IDP that has not been used earlier.</li><li>Knowledge of the username of a valid user in the local IDP.</li></ul><p>When all preconditions are met, a malicious actor could use JIT provisioning flow to perform user impersonation.</p>"
                        }
                    ],
                    "value": "Multiple WSO2 products have been identified as vulnerable to perform user impersonatoin using JIT provisioning. In order for this vulnerability to have any impact on your deployment, following conditions must be met:\n\n  *  An IDP configured for federated authentication and JIT provisioning enabled with the \"Prompt for username, password and consent\" option.\n  *  A service provider that uses the above IDP for federated authentication and has the \"Assert identity using mapped local subject identifier\" flag enabled.\n\n\nAttacker should have:\n\n  *  A fresh valid user account in the federated IDP that has not been used earlier.\n  *  Knowledge of the username of a valid user in the local IDP.\n\n\nWhen all preconditions are met, a malicious actor could use JIT provisioning flow to perform user impersonation.\n\n"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 8.5,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "LOW",
                        "privilegesRequired": "LOW",
                        "scope": "CHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "ed10eef1-636d-4fbe-9993-6890dfa878f8",
                "shortName": "WSO2",
                "dateUpdated": "2024-02-07T05:36:55.643Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "For WSO2 Subscription holders, the recommended solution is to apply the provided patch/update to the affected versions of the products. If there are any instructions given with the patch/update, please make sure those are followed properly.<br><br>Community users may apply the relevant fixes to the product based on the public fix(s) advertised in&nbsp;<a target=\"_blank\" rel=\"nofollow\" href=\"https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/\">https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1...</a><br>"
                        }
                    ],
                    "value": "For WSO2 Subscription holders, the recommended solution is to apply the provided patch/update to the affected versions of the products. If there are any instructions given with the patch/update, please make sure those are followed properly.\n\nCommunity users may apply the relevant fixes to the product based on the public fix(s) advertised in  https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1... https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1573/ \n"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}