{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2023-6245",
        "assignerOrgId": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
        "state": "PUBLISHED",
        "assignerShortName": "Dfinity",
        "dateReserved": "2023-11-21T16:28:51.715Z",
        "datePublished": "2023-12-08T14:26:09.331Z",
        "dateUpdated": "2023-12-08T14:26:09.331Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Candid",
                    "repo": "https://github.com/dfinity/candid",
                    "vendor": "Internet Computer",
                    "versions": [
                        {
                            "lessThan": "0.9.10",
                            "status": "affected",
                            "version": "0.9.0",
                            "versionType": "0.0.0"
                        }
                    ]
                }
            ],
            "datePublic": "2023-12-08T01:55:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>The Candid library causes a Denial of Service while \nparsing a specially crafted payload with 'empty' data type. For example,\n if the payload is <code>`record { * ; empty }`</code> and the canister interface expects <code>`record { * }`</code> then the Rust candid decoder treats <code>empty</code> as an extra field required by the type.  The problem with the type <code>empty</code> is that the candid Rust library wrongly categorizes <code>empty</code> as a recoverable error when skipping the field and thus causing an infinite decoding loop.</p>\n<p>Canisters using affected versions of candid\n are exposed to denial of service by causing the decoding to run \nindefinitely until the canister traps due to reaching maximum \ninstruction limit per execution round. Repeated exposure to the payload \nwill result in degraded performance of the canister. Note: Canisters written in Motoko are unaffected.<br></p><br>"
                        }
                    ],
                    "value": "The Candid library causes a Denial of Service while \nparsing a specially crafted payload with 'empty' data type. For example,\n if the payload is `record { * ; empty }` and the canister interface expects `record { * }` then the Rust candid decoder treats empty as an extra field required by the type.  The problem with the type empty is that the candid Rust library wrongly categorizes empty as a recoverable error when skipping the field and thus causing an infinite decoding loop.\n\n\nCanisters using affected versions of candid\n are exposed to denial of service by causing the decoding to run \nindefinitely until the canister traps due to reaching maximum \ninstruction limit per execution round. Repeated exposure to the payload \nwill result in degraded performance of the canister. Note: Canisters written in Motoko are unaffected.\n\n\n\n"
                }
            ],
            "impacts": [
                {
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "Denial of Service"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-835",
                            "description": "CWE-835 Loop with Unreachable Exit Condition ('Infinite Loop')",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-1288",
                            "description": "CWE-1288 Improper Validation of Consistency within Input",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-168",
                            "description": "CWE-168 Improper Handling of Inconsistent Special Elements",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-20",
                            "description": "CWE-20 Improper Input Validation",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
                "shortName": "Dfinity",
                "dateUpdated": "2023-12-08T14:26:09.331Z"
            },
            "references": [
                {
                    "url": "https://github.com/dfinity/candid/pull/478"
                },
                {
                    "url": "https://internetcomputer.org/docs/current/references/candid-ref"
                },
                {
                    "url": "https://github.com/dfinity/candid/blob/master/spec/Candid.md"
                },
                {
                    "url": "https://github.com/dfinity/candid/security/advisories/GHSA-7787-p7x6-fq3j"
                },
                {
                    "url": "https://internetcomputer.org/docs/current/references/ic-interface-spec"
                }
            ],
            "source": {
                "discovery": "INTERNAL"
            },
            "title": "Infinite decoding loop through specially crafted payload",
            "x_generator": {
                "engine": "Vulnogram 0.1.0-dev"
            }
        }
    }
}