{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "state": "PUBLISHED",
        "cveId": "CVE-2022-22219",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "datePublished": "2022-10-12T00:00:00",
        "dateUpdated": "2022-10-18T00:00:00",
        "dateReserved": "2021-12-21T00:00:00"
    },
    "containers": {
        "cna": {
            "title": "Junos OS and Junos OS Evolved: RPD core upon receipt of a specific EVPN route by a BGP route reflector in an EVPN environment",
            "datePublic": "2022-10-12T00:00:00",
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2022-10-18T00:00:00"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Due to the Improper Handling of an Unexpected Data Type in the processing of EVPN routes on Juniper Networks Junos OS and Junos OS Evolved, an attacker in direct control of a BGP client connected to a route reflector, or via a machine in the middle (MITM) attack, can send a specific EVPN route contained within a BGP Update, triggering a routing protocol daemon (RPD) crash, leading to a Denial of Service (DoS) condition. Continued receipt and processing of these specific EVPN routes could create a sustained Denial of Service (DoS) condition. This issue only occurs on BGP route reflectors, only within a BGP EVPN multicast environment, and only when one or more BGP clients have 'leave-sync-route-oldstyle' enabled. This issue affects: Juniper Networks Junos OS 21.3 versions prior to 21.3R3-S2; 21.4 versions prior to 21.4R2-S2, 21.4R3; 22.1 versions prior to 22.1R1-S2, 22.1R3; 22.2 versions prior to 22.2R2. Juniper Networks Junos OS Evolved 21.3 version 21.3R1-EVO and later versions prior to 21.4R3-EVO; 22.1 versions prior to 22.1R1-S2-EVO, 22.1R3-EVO; 22.2 versions prior to 22.2R2-EVO. This issue does not affect: Juniper Networks Junos OS versions prior to 21.3R1. Juniper Networks Junos OS Evolved versions prior to 21.3R1-EVO."
                }
            ],
            "affected": [
                {
                    "vendor": "Juniper Networks",
                    "product": "Junos OS",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThanOrEqual": "21.3R1",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3",
                            "status": "affected",
                            "lessThan": "21.3R3-S2",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.4",
                            "status": "affected",
                            "lessThan": "21.4R2-S2, 21.4R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.1",
                            "status": "affected",
                            "lessThan": "22.1R1-S2, 22.1R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.2",
                            "status": "affected",
                            "lessThan": "22.2R2",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "vendor": "Juniper Networks",
                    "product": "Junos OS Evolved",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "21.3R1-EVO",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3R1-EVO",
                            "status": "affected",
                            "lessThan": "21.3*",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.4",
                            "status": "affected",
                            "lessThan": "21.4R3-EVO",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.1",
                            "status": "affected",
                            "lessThan": "22.1R1-S2-EVO, 22.1R3-EVO",
                            "versionType": "custom"
                        },
                        {
                            "version": "22.2",
                            "status": "affected",
                            "lessThan": "22.2R2-EVO",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://kb.juniper.net/JSA69898"
                },
                {
                    "url": "https://www.juniper.net/documentation/us/en/software/junos/evpn-vxlan/topics/ref/statement/evpn-edit-routing-instances-protocols.html"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "attackVector": "NETWORK",
                        "attackComplexity": "HIGH",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "HIGH",
                        "baseScore": 5.9,
                        "baseSeverity": "MEDIUM"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-241 Improper Handling of Unexpected Data Type",
                            "cweId": "CWE-241"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "type": "text",
                            "lang": "en",
                            "description": "Denial of Service (DoS)"
                        }
                    ]
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "source": {
                "advisory": "JSA69898",
                "defect": [
                    "1675054"
                ],
                "discovery": "USER"
            },
            "configurations": [
                {
                    "lang": "en",
                    "value": "This issue can occur when the following configuration is enabled on the route reflector clients:\n\n  [protocols evpn leave-sync-route-oldstyle]\n\nand when EVPN is configured on the route reflector: \n\n  [protocols evpn]"
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "Enabling 'leave-sync-route-oldstyle' on the BGP route reflector will mitigate the RPD crash, but BGP sessions may still be torn down if one or more clients have 'leave-sync-route-oldstyle' enabled.\n\n\n"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "The following software releases have been updated to resolve this specific issue:\nJunos OS 21.3R3-S2, 21.4R2-S2, 21.4R3, 22.1R1-S2, 22.1R3, 22.2R2, 22.3R1, and all subsequent releases.\nJunos OS Evolved 21.4R3-EVO, 22.1R1-S2-EVO, 22.1R3-EVO, 22.2R2-EVO, 22.3R1-EVO, and all subsequent releases.\n"
                }
            ]
        }
    }
}