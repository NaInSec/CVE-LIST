{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "state": "PUBLISHED",
        "cveId": "CVE-2022-22225",
        "assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
        "assignerShortName": "juniper",
        "datePublished": "2022-10-12T00:00:00",
        "dateUpdated": "2022-10-18T00:00:00",
        "dateReserved": "2021-12-21T00:00:00"
    },
    "containers": {
        "cna": {
            "title": "Junos OS and Junos OS Evolved: In a BGP multipath scenario, when one of the contributing routes is flapping often and rapidly, rpd may crash",
            "datePublic": "2022-10-12T00:00:00",
            "providerMetadata": {
                "orgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
                "shortName": "juniper",
                "dateUpdated": "2022-10-18T00:00:00"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "A Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in the Routing Protocol Daemon (rpd) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated attacker with an established BGP session to cause a Denial of Service (DoS). In a BGP multipath scenario, when one of the contributing routes is flapping often and rapidly, rpd may crash. As this crash depends on whether a route is a contributing route, and on the internal timing of the events triggered by the flap this vulnerability is outside the direct control of a potential attacker. This issue affects: Juniper Networks Junos OS 19.2 versions prior to 19.2R3-S6; 20.2 versions prior to 20.2R3-S4; 20.3 versions prior to 20.3R3-S3; 20.4 versions prior to 20.4R3-S4; 21.1 versions prior to 21.1R3; 21.2 versions prior to 21.2R2; 21.3 versions prior to 21.3R2. Juniper Networks Junos OS Evolved All versions prior to 20.4R3-S4-EVO; 21.1-EVO version 21.1R1-EVO and later versions; 21.2-EVO versions prior to 21.2R2-EVO; 21.3-EVO versions prior to 21.3R2-EVO. This issue does not affect: Juniper Networks Junos OS versions 19.2 versions prior to 19.2R2, 19.3R1 and above prior to 20.2R1. Juniper Networks Junos OS Evolved versions prior to 20.2R1-EVO."
                }
            ],
            "affected": [
                {
                    "vendor": "Juniper Networks",
                    "product": "Junos OS",
                    "versions": [
                        {
                            "version": "19.2",
                            "status": "unaffected",
                            "lessThan": "19.2R2",
                            "versionType": "custom",
                            "changes": [
                                {
                                    "at": "19.2R3-S6",
                                    "status": "unaffected"
                                }
                            ]
                        },
                        {
                            "version": "19.3R1",
                            "status": "unaffected",
                            "lessThan": "19.3*",
                            "versionType": "custom"
                        },
                        {
                            "version": "19.4R1",
                            "status": "unaffected",
                            "lessThan": "19.4*",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.1R1",
                            "status": "unaffected",
                            "lessThan": "20.1*",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.2",
                            "status": "affected",
                            "lessThan": "20.2R3-S4",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.3",
                            "status": "affected",
                            "lessThan": "20.3R3-S3",
                            "versionType": "custom"
                        },
                        {
                            "version": "20.4",
                            "status": "affected",
                            "lessThan": "20.4R3-S4",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.1",
                            "status": "affected",
                            "lessThan": "21.1R3",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.2",
                            "status": "affected",
                            "lessThan": "21.2R2",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3",
                            "status": "affected",
                            "lessThan": "21.3R2",
                            "versionType": "custom"
                        }
                    ]
                },
                {
                    "vendor": "Juniper Networks",
                    "product": "Junos OS Evolved",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "20.4R3-S4-EVO",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "unspecified",
                            "lessThan": "20.2R1-EVO",
                            "status": "unaffected",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.1R1-EVO",
                            "status": "affected",
                            "lessThan": "21.1-EVO*",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.2-EVO",
                            "status": "affected",
                            "lessThan": "21.2R2-EVO",
                            "versionType": "custom"
                        },
                        {
                            "version": "21.3-EVO",
                            "status": "affected",
                            "lessThan": "21.3R2-EVO",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://kb.juniper.net/JSA69875"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "attackVector": "NETWORK",
                        "attackComplexity": "HIGH",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "HIGH",
                        "baseScore": 5.9,
                        "baseSeverity": "MEDIUM"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "text",
                            "lang": "en",
                            "description": "Denial of Service (DoS)"
                        }
                    ]
                },
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-367 Time-of-check Time-of-use (TOCTOU) Race Condition",
                            "cweId": "CWE-367"
                        }
                    ]
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.0.9"
            },
            "source": {
                "advisory": "JSA69875",
                "defect": [
                    "1611128"
                ],
                "discovery": "INTERNAL"
            },
            "configurations": [
                {
                    "lang": "en",
                    "value": "A device can only be affected if the following BGP multipath configuration is in place:\n\n  [protocols bgp ... multipath]"
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "There are no viable workarounds for this issue.\n"
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "The following software releases have been updated to resolve this specific issue: \nJunos OS: 19.2R3-S6, 20.2R3-S4, 20.3R3-S3, 20.4R3-S4, 21.1R2, 21.2R2, 21.3R2, 21.4R1, and all subsequent releases.\nJunos OS Evolved: 20.4R3-S4-EVO, 21.2R2-EVO, 21.3R2-EVO, 21.4R1-EVO, and all subsequent releases.\n"
                }
            ]
        }
    }
}