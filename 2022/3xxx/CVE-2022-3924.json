{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2022-3924",
        "assignerOrgId": "404fd4d2-a609-4245-b543-2c944a302a22",
        "state": "PUBLISHED",
        "assignerShortName": "isc",
        "dateReserved": "2022-11-10T09:07:37.642Z",
        "datePublished": "2023-01-25T21:39:49.110Z",
        "dateUpdated": "2023-01-26T06:03:10.975661Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "404fd4d2-a609-4245-b543-2c944a302a22",
                "shortName": "isc",
                "dateUpdated": "2023-01-26T06:03:10.975661Z"
            },
            "title": "named configured to answer from stale cache may terminate unexpectedly at recursive-clients soft quota",
            "datePublic": "2023-01-25T00:00:00Z",
            "affected": [
                {
                    "vendor": "ISC",
                    "product": "BIND 9",
                    "versions": [
                        {
                            "version": "9.16.12",
                            "lessThanOrEqual": "9.16.36",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "9.18.0",
                            "lessThanOrEqual": "9.18.10",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "9.19.0",
                            "lessThanOrEqual": "9.19.8",
                            "status": "affected",
                            "versionType": "custom"
                        },
                        {
                            "version": "9.16.12-S1",
                            "lessThanOrEqual": "9.16.36-S1",
                            "status": "affected",
                            "versionType": "custom"
                        }
                    ],
                    "defaultStatus": "unaffected"
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "version": "3.1",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "NONE",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "HIGH",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH"
                    }
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "value": "This issue can affect BIND 9 resolvers with `stale-answer-enable yes;` that also make use of the option `stale-answer-client-timeout`, configured with a value greater than zero.\n\nIf the resolver receives many queries that require recursion, there will be a corresponding increase in the number of clients that are waiting for recursion to complete. If there are sufficient clients already waiting when a new client query is received so that it is necessary to SERVFAIL the longest waiting client (see BIND 9 ARM `recursive-clients` limit and soft quota), then it is possible for a race to occur between providing a stale answer to this older client and sending an early timeout SERVFAIL, which may cause an assertion failure.\nThis issue affects BIND 9 versions 9.16.12 through 9.16.36, 9.18.0 through 9.18.10, 9.19.0 through 9.19.8, and 9.16.12-S1 through 9.16.36-S1."
                }
            ],
            "impacts": [
                {
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "By sending specific queries to the resolver, an attacker can cause `named` to crash."
                        }
                    ]
                }
            ],
            "workarounds": [
                {
                    "lang": "en",
                    "value": "Disabling `stale-answer-client-timeout` entirely or setting the timeout value to zero prevents the problem.\n\nIt is not possible to disable the limit on `recursive-clients`, though it could be set to a very high value in order to reduce the likelihood of encountering this scenario. However, this is not recommended as the limit on recursive clients is important for preventing exhaustion of server resources."
                }
            ],
            "exploits": [
                {
                    "lang": "en",
                    "value": "We are not aware of any active exploits."
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "value": "Upgrade to the patched release most closely related to your current version of BIND 9: 9.16.37, 9.18.11, 9.19.9, or 9.16.37-S1."
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "value": "ISC would like to thank Maksym Odinintsev from AWS for bringing this vulnerability to our attention."
                }
            ],
            "references": [
                {
                    "url": "https://kb.isc.org/docs/cve-2022-3924",
                    "name": "CVE-2022-3924",
                    "tags": [
                        "vendor-advisory"
                    ]
                }
            ],
            "source": {
                "discovery": "EXTERNAL"
            },
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "description": "n/a",
                            "lang": "en",
                            "type": "text"
                        }
                    ]
                }
            ]
        }
    }
}