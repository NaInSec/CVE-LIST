{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.0",
    "cveMetadata": {
        "cveId": "CVE-2022-46163",
        "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "state": "PUBLISHED",
        "assignerShortName": "GitHub_M",
        "dateReserved": "2022-11-28T17:27:19.997Z",
        "datePublished": "2023-01-10T20:26:02.980Z"
    },
    "containers": {
        "cna": {
            "title": "travel-support-program vulnerable to data exfiltration via Ransack query injection",
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-200",
                            "lang": "en",
                            "description": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "NONE",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
                        "version": "3.1"
                    }
                }
            ],
            "references": [
                {
                    "name": "https://github.com/openSUSE/travel-support-program/security/advisories/GHSA-2wwv-c6xh-cf68",
                    "tags": [
                        "x_refsource_CONFIRM"
                    ],
                    "url": "https://github.com/openSUSE/travel-support-program/security/advisories/GHSA-2wwv-c6xh-cf68"
                },
                {
                    "name": "https://github.com/openSUSE/travel-support-program/pull/158",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/openSUSE/travel-support-program/pull/158"
                },
                {
                    "name": "https://github.com/openSUSE/travel-support-program/commit/d22916275c51500b4004933ff1b0a69bc807b2b7",
                    "tags": [
                        "x_refsource_MISC"
                    ],
                    "url": "https://github.com/openSUSE/travel-support-program/commit/d22916275c51500b4004933ff1b0a69bc807b2b7"
                }
            ],
            "affected": [
                {
                    "vendor": "openSUSE",
                    "product": "travel-support-program",
                    "versions": [
                        {
                            "version": "< d22916275c51500b4004933ff1b0a69bc807b2b7",
                            "status": "affected"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
                "shortName": "GitHub_M",
                "dateUpdated": "2023-01-10T20:26:02.980Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "Travel support program is a rails app to support the travel support program of openSUSE (TSP). Sensitive user data (bank account details, password Hash) can be extracted via Ransack query injection. Every deployment of travel-support-program below the patched version is affected. The travel-support-program uses the Ransack library to implement search functionality. In its default configuration, Ransack will allow for query conditions based on properties of associated database objects [1]. The `*_start`, `*_end` or `*_cont` search matchers [2] can then be abused to exfiltrate sensitive string values of associated database objects via character-by-character brute-force (A match is indicated by the returned JSON not being empty). A single bank account number can be extracted with <200 requests, a password hash can be extracted with ~1200 requests, all within a few minutes. The problem has been patched in commit d22916275c51500b4004933ff1b0a69bc807b2b7. In order to work around this issue, you can also cherry pick that patch, however it will not work without the Rails 5.0 migration that was done in #150, which in turn had quite a few pull requests it depended on."
                }
            ],
            "source": {
                "advisory": "GHSA-2wwv-c6xh-cf68",
                "discovery": "UNKNOWN"
            }
        }
    }
}